!function(){let e={x:0,y:0},t={x:0,y:0};const n=/[:]/,i=/[%]/,d=/[px]/;let s,o=[],r=[],l=[];function a(){let n=document.querySelectorAll("BINDER");for(let e of n){let t=e.id,n=o.push(new h(e))-1;t&&(r[t]=n),r[n.toString()]=n,l.push(n),o[n].node.style.zIndex=l.length-1}document.addEventListener("mouseup",(function(){s&&s.makeInactive()}),!1),document.addEventListener("mousemove",(function(n){t={x:e.x,y:e.y},e={x:n.clientX,y:n.clientY},s&&(s.pos.x+=e.x-t.x,s.pos.y+=e.y-t.y,s.translateX(s.pos.x),s.translateY(s.pos.y))}),!1)}function h(e){this.node=u(e),this.pos={x:0,y:0},this.dim={width:0,height:0},this.pageList=[],this.pageNames=[],this.currentPage=0,this.init=function(){let e=this.node.id;e||(e=o.length.toString()),this.node.id="binder:"+e,this.node.style.display="block";let t=this.node.querySelectorAll("PAGE");for(let e of t){e=u(e);let t=this.pageList.push(e)-1,n=e.id;n?this.pageNames[e.id]=t:n=this.pageList.length.toString(),e.id="page:"+n,this.pageNames[t.toString()]=t,e.style.display="none"}this.node.style.position="fixed",this.openPage(0),this.readNewCSS(),this.resize(this.node.attributes.width,this.node.attributes.height),this.readNewCSS(),this.translateX(this.node.attributes.x),this.translateY(this.node.attributes.y),void 0!==this.node.attributes.hidden&&"false"!=this.node.attributes.hidden&&(this.node.style.display="none")},this.makeActive=function(){this.readNewCSS(),this.node.style.userSelect="none",s=this},this.makeInactive=function(){this.node.style.userSelect="auto",s=null},this.openPage=function(e){"string"==typeof e&&(e=this.pageNames[e]),this.pageList[this.currentPage].style.display="none",this.pageList[e].style.display="block",this.currentPage=e},this.hide=()=>this.node.style.display="none",this.show=()=>this.node.style.display="block",this.readNewCSS=function(){let e=window.getComputedStyle(this.node);this.pos={x:parseInt(e.left),y:parseInt(e.top)},this.dim={width:parseInt(e.width)+parseInt(e["padding-left"])+parseInt(e["padding-right"]),height:parseInt(e.height)+parseInt(e["padding-top"])+parseInt(e["padding-bottom"])}},this.translateX=function(e){"number"==typeof e?this.node.style.left=e.toString()+"px":i.test(e)?(e=parseInt(e),e=window.innerWidth*e/100-this.dim.width*e/100,this.node.style.left=e.toString()+"px"):d.test(e)&&(this.node.style.left=e)},this.translateY=function(e){"number"==typeof e?this.node.style.top=e.toString()+"px":i.test(e)?(e=parseInt(e),e=window.innerHeight*e/100-this.dim.height*e/100,this.node.style.top=e.toString()+"px"):d.test(e)&&(this.node.style.top=e)},this.resize=function(e,t){"number"==typeof e?this.node.style.top=e.toString()+"px":i.test(e)?(e=window.innerWidth*parseInt(e)/100,this.node.style.width=e.toString()+"px"):d.test(e)&&(this.node.style.width=e),"number"==typeof t?this.node.style.height=t.toString()+"px":i.test(t)?(t=window.innerHeight*parseInt(t)/100,this.node.style.height=t.toString()+"px"):d.test(t)&&(this.node.style.height=t)},this.init()}function u(e){let t=document.createElement("SPAN");for(let n of e.attributes)t.attributes[n.name]=n.value;for(let n of e.children)t.appendChild(n.cloneNode(!0));return e.parentNode.insertBefore(t,e),function(e,t){oldStyle=window.getComputedStyle(e),newStyle=window.getComputedStyle(t);for(let e of oldStyle)oldStyle[e]!=newStyle[e]&&(t.style[e]=oldStyle[e])}(e,t),t.id=e.id,e.remove(),t}window.onload=function(){a()},window.pageQuery=function(){a()},window.translateBinder=function(e=null,t=null,n=null){n=n?getBinderIndex(n):findParentBinder(event.srcElement),o[n].readNewCSS(),o[n].translateX(e),o[n].translateY(t)},window.resizeBinder=function(e=null,t=null,n=null){n=n?getBinderIndex(n):findParentBinder(event.srcElement),o[n].readNewCSS(),o[n].resize(e,t)},window.bringToFront=function(e=null){e=e?getBinderIndex(e):findParentBinder(event.srcElement);let t=l.indexOf(e);for(l.splice(t,1);t<l.length;t++)o[l[t]].node.style.zIndex--;l[t]=e,o[e].node.style.zIndex=t},window.openBinder=function(e){e=e?getBinderIndex(e):findParentBinder(event.srcElement),bringToFront(e),o[e].show()},window.closeBinder=function(e=null){e=e?getBinderIndex(e):findParentBinder(event.srcElement),o[e].hide()},window.getBinder=function(e=null){if(e=e?getBinderIndex(e):findParentBinder(event.srcElement),o[e])return o[e]},window.openPage=function(e,t=null){t=t?getBinderIndex(t):findParentBinder(event.srcElement),o[t].openPage(e)},window.prevPage=function(e=null){e=e?getBinderIndex(e):findParentBinder(event.srcElement);let t=o[e].currentPage;t>0&&o[e].openPage(t-1)},window.nextPage=function(e=null){e=e?getBinderIndex(e):findParentBinder(event.srcElement);let t=o[e].currentPage;t<o[e].pageList.length&&o[e].openPage(t+1)},window.getCurrentPage=function(e=null){return e=e?getBinderIndex(e):findParentBinder(event.srcElement),o[e].currentPage},window.dragBinder=function(e=null){e=e?getBinderIndex(e):findParentBinder(event.srcElement),o[e].makeActive(),bringToFront(e)},window.getBinderIndex=function(e=null){return"number"==typeof e?e:"string"==typeof e?r[e]:"object"==typeof e?o.indexOf(e):void 0},window.findParentBinder=function(e){let t=e.parentNode;for(;t;){if("SPAN"==t.tagName){let e=t.id.split(n);if("binder"==e[0])return getBinderIndex(e[1])}t=t.parentNode}}}();
