!function(){let e={x:0,y:0},t={x:0,y:0};const n=new RegExp(" "),i=new RegExp("page "),d=new RegExp("%"),o=new RegExp("px"),s=new RegExp("(.*?)");let r,l=[],a=[],h=[];function u(){let n=document.querySelectorAll("BINDER");for(let e of n)f(e);document.addEventListener("mouseup",(function(){r&&r.makeInactive()}),!1),document.addEventListener("mousemove",(function(n){t={x:e.x,y:e.y},e={x:n.clientX,y:n.clientY},r&&(r.pos.x+=e.x-t.x,r.pos.y+=e.y-t.y,r.translateX(r.pos.x),r.translateY(r.pos.y))}),!1)}function g(e){this.node=e,this.pos={x:0,y:0},this.dim={width:0,height:0},this.pageList=[],this.pageNames=[],this.currentPage=0,this.init=function(){let e=this.node.id;if(e||(e=l.length.toString()),this.node.id="binder "+e,this.node.style.display="block","BINDER"==this.node.tagName){this.node=p(this.node);let e=this.node.querySelectorAll("PAGE");for(let t of e)this.loadPage(p(t))}else if("SPAN"==this.node.tagName){let e=this.node.querySelectorAll("SPAN");for(let t of e)i.test(t.id)&&this.loadPage(t)}this.node.style.position="fixed",this.openPage(0),this.readNewCSS(),this.resize(this.node.attributes.width,this.node.attributes.height),this.readNewCSS(),this.translateX(this.node.attributes.x),this.translateY(this.node.attributes.y),void 0!==this.node.attributes.hidden&&"false"!=this.node.attributes.hidden&&(this.node.style.display="none")},this.loadPage=function(e){let t=this.pageList.push(e)-1,n=e.id;n?this.pageNames[e.id]=t:n=this.pageList.length.toString(),e.id="page "+n,this.pageNames[t.toString()]=t,e.style.display="none"},this.makeActive=function(){this.readNewCSS(),this.node.style.userSelect="none",r=this},this.makeInactive=function(){this.node.style.userSelect="auto",r=null},this.openPage=function(e){"string"==typeof e&&(e=this.pageNames[e]),this.pageList[this.currentPage].style.display="none",this.pageList[e].style.display="block",this.currentPage=e},this.hide=()=>this.node.style.display="none",this.show=()=>this.node.style.display="block",this.readNewCSS=function(){let e=window.getComputedStyle(this.node);this.pos={x:parseInt(e.left),y:parseInt(e.top)},this.dim={width:parseInt(e.width)+parseInt(e["padding-left"])+parseInt(e["padding-right"]),height:parseInt(e.height)+parseInt(e["padding-top"])+parseInt(e["padding-bottom"])}},this.translateX=function(e){"number"==typeof e?this.node.style.left=e.toString()+"px":d.test(e)?(e=parseInt(e),e=window.innerWidth*e/100-this.dim.width*e/100,this.node.style.left=e.toString()+"px"):o.test(e)&&(this.node.style.left=e)},this.translateY=function(e){"number"==typeof e?this.node.style.top=e.toString()+"px":d.test(e)?(e=parseInt(e),e=window.innerHeight*e/100-this.dim.height*e/100,this.node.style.top=e.toString()+"px"):o.test(e)&&(this.node.style.top=e)},this.resize=function(e,t){"number"==typeof e?this.node.style.top=e.toString()+"px":d.test(e)?(e=window.innerWidth*parseInt(e)/100,this.node.style.width=e.toString()+"px"):o.test(e)&&(this.node.style.width=e),"number"==typeof t?this.node.style.height=t.toString()+"px":d.test(t)?(t=window.innerHeight*parseInt(t)/100,this.node.style.height=t.toString()+"px"):o.test(t)&&(this.node.style.height=t)},this.init()}function p(e){let t=document.createElement("SPAN");for(let n of e.attributes)t.attributes[n.name]=n.value,s.test(n.value)&&t.setAttribute(n.name,n.value);for(let n of e.children)t.appendChild(n.cloneNode(!0));return e.parentNode.insertBefore(t,e),function(e,t){oldStyle=window.getComputedStyle(e),newStyle=window.getComputedStyle(t);for(let e of oldStyle)oldStyle[e]!=newStyle[e]&&(t.style[e]=oldStyle[e])}(e,t),t.id=e.id,e.remove(),t}function f(e){let t=e.id,n=l.push(new g(e))-1;return t&&(a[t]=n),a[n.toString()]=n,h.push(n),l[n].node.style.zIndex=h.length-1,l[n]}window.onload=function(){u()},window.pageQuery=function(){u()},window.translateBinder=function(e=null,t=null,n=null){n=n||0==n?getBinderIndex(n):findParentBinder(event.srcElement),l[n].readNewCSS(),l[n].translateX(e),l[n].translateY(t)},window.resizeBinder=function(e=null,t=null,n=null){n=n||0==n?getBinderIndex(n):findParentBinder(event.srcElement),l[n].readNewCSS(),l[n].resize(e,t)},window.bringToFront=function(e=null){e=e||0==e?getBinderIndex(e):findParentBinder(event.srcElement);let t=h.indexOf(e);for(h.splice(t,1);t<h.length;t++)l[h[t]].node.style.zIndex--;h[t]=e,l[e].node.style.zIndex=t},window.openBinder=function(e){e=e||0==e?getBinderIndex(e):findParentBinder(event.srcElement),bringToFront(e),l[e].show()},window.closeBinder=function(e=null){e=e||0==e?getBinderIndex(e):findParentBinder(event.srcElement),l[e].hide()},window.getBinder=function(e=null){if(e=e||0==e?getBinderIndex(e):findParentBinder(event.srcElement),l[e])return l[e]},window.openPage=function(e,t=null){t=t||0==t?getBinderIndex(t):findParentBinder(event.srcElement),l[t].openPage(e)},window.prevPage=function(e=null){e=e||0==e?getBinderIndex(e):findParentBinder(event.srcElement);let t=l[e].currentPage;t>0&&l[e].openPage(t-1)},window.nextPage=function(e=null){e=e||0==e?getBinderIndex(e):findParentBinder(event.srcElement);let t=l[e].currentPage;t<l[e].pageList.length-1&&l[e].openPage(t+1)},window.getCurrentPage=function(e=null){return e=e||0==e?getBinderIndex(e):findParentBinder(event.srcElement),l[e].currentPage},window.dragBinder=function(e=null){e=e||0==e?getBinderIndex(e):findParentBinder(event.srcElement),l[e].makeActive(),bringToFront(e)},window.getBinderIndex=function(e=null){return"number"==typeof e?e:"string"==typeof e?a[e]:"object"==typeof e?l.indexOf(e):void 0},window.findParentBinder=function(e){for(;e;){if("SPAN"==e.tagName){let t=e.id.split(n);if("binder"==t[0])return getBinderIndex(t[1])}e=e.parentNode}},window.cloneBinder=function(e=null,t=null){t=t||0==t?getBinderIndex(t):findParentBinder(event.srcElement);let n=l[t].node.cloneNode(!0);return a[e]?n.id="":n.id=e,document.querySelector("body").appendChild(n),f(n)},window.deleteBinder=function(e=null){e=e||0==e?getBinderIndex(e):findParentBinder(event.srcElement),l[e].node.remove(),l[e]=void 0;let t=h.indexOf(e);for(h.splice(t,1);t<h.length;t++)l[h[t]].node.style.zIndex--}}();
